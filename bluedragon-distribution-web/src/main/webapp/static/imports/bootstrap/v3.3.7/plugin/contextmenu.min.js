(function(t){"use strict";var e='[data-toggle="context"]';var n=function(e,n){this.$element=t(e);this.before=n.before||this.before;this.onItem=n.onItem||this.onItem;this.scopes=n.scopes||null;if(n.target){this.$element.data("target",n.target)}this.listen()};n.prototype={constructor:n,show:function(e){var n,o,i,s,r={relatedTarget:this,target:e.currentTarget};if(this.isDisabled())return;this.closemenu();if(this.before.call(this,e,t(e.currentTarget))===false)return;n=this.getMenu();n.trigger(o=t.Event("show.bs.context",r));i=this.getPosition(e,n);s="li:not(.divider)";n.attr("style","").css(i).addClass("open").on("click.context.data-api",s,t.proxy(this.onItem,this,t(e.currentTarget))).trigger("shown.bs.context",r);t("html").on("click.context.data-api",n.selector,t.proxy(this.closemenu,this));return false},closemenu:function(e){var n,o,i,s;n=this.getMenu();if(!n.hasClass("open"))return;s={relatedTarget:this};n.trigger(o=t.Event("hide.bs.context",s));i="li:not(.divider)";n.removeClass("open").off("click.context.data-api",i).trigger("hidden.bs.context",s);t("html").off("click.context.data-api",n.selector);if(e){e.stopPropagation()}},keydown:function(t){if(t.which==27)this.closemenu(t)},before:function(t){return true},onItem:function(t){return true},listen:function(){this.$element.on("contextmenu.context.data-api",this.scopes,t.proxy(this.show,this));t("html").on("click.context.data-api",t.proxy(this.closemenu,this));t("html").on("keydown.context.data-api",t.proxy(this.keydown,this))},destroy:function(){this.$element.off(".context.data-api").removeData("context");t("html").off(".context.data-api")},isDisabled:function(){return this.$element.hasClass("disabled")||this.$element.attr("disabled")},getMenu:function(){var e=this.$element.data("target"),n;if(!e){e=this.$element.attr("href");e=e&&e.replace(/.*(?=#[^\s]*$)/,"")}n=t(e);return n&&n.length?n:this.$element.find(e)},getPosition:function(e,n){var o=e.clientX,i=e.clientY,s=t(window).width(),r=t(window).height(),a=n.find(".dropdown-menu").outerWidth(),c=n.find(".dropdown-menu").outerHeight(),l={position:"absolute","z-index":9999},h,f,u;if(i+c>r){h={top:i-c+t(window).scrollTop()}}else{h={top:i+t(window).scrollTop()}}if(o+a>s&&o-a>0){f={left:o-a+t(window).scrollLeft()}}else{f={left:o+t(window).scrollLeft()}}u=n.offsetParent().offset();f.left=f.left-u.left;h.top=h.top-u.top;return t.extend(l,h,f)}};t.fn.contextmenu=function(e,o){return this.each(function(){var i=t(this),s=i.data("context"),r=typeof e=="object"&&e;if(!s)i.data("context",s=new n(i,r));if(typeof e=="string")s[e].call(s,o)})};t.fn.contextmenu.Constructor=n;t(document).on("contextmenu.context.data-api",function(){t(e).each(function(){var e=t(this).data("context");if(!e)return;e.closemenu()})}).on("contextmenu.context.data-api",e,function(e){t(this).contextmenu("show",e);e.preventDefault();e.stopPropagation()})})(jQuery);